---
title: 'Jogos de Tabuleiro "Solo"'
subtitle: "Curso de Visualização I - Curso-R"
author: "Marcio Vakassugui"
date: '2022-04-29'

output: 
  html_document:
    highlight: breezedark
    code_folding: hide
    self_contained: true
    theme: lumen
    toc: yes
    toc_float: yes
    smooth_scroll: no
    collapsed: yes
runtime: shiny
---

```{r setup }
#| include=FALSE

knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE,
  fig.width = 14,
  fig.height = 7
)

```


```{r inclui figura jogo tabuleiro}
#| fig.align = "center",
#| out.width = "100%",
#| echo = FALSE,

knitr::include_graphics("https://www.deveserisso.com.br/blog/wp-content/uploads/2015/10/colonizadores-de-catan.jpg")
```

# Contexto

<div align=justify style="text-indent: 3em;"> Durante a pandemia da covid-19 e em plena era dos jogos digitais, o interesse das pessoas por jogos de mesa e de tabuleiro, que retornaram às prateiras das lojas e *sites* especializados, tem aumentado. Segundo dados da *Euromonitor International*, empresa britânica de pesquisa de mercado,  a combinação de tempo livre e nostalgia fez com que os europeus voltassem a procurá-los. No Brasil, o mercado de brinquedos e jogos tradicionais aumentou de 1% do período pré-pandêmico para 3,16% em 2022.

Este fenômeno tem mexido com indústria de "games" eletrônicos e de mesa, tanto que jogos como [*"Assassin's  Creed"*](https://olhardigital.com.br/2022/03/17/games-e-consoles/jogo-de-tabuleiro-de-assassins-creed-sera-lancado-em-2022/) e [*"The Elder Scrolls 5: Skyrim"*](https://canaltech.com.br/games/the-elder-scrolls-5-skyrim-tera-jogo-de-tabuleiro-em-2022-200773/), ambos disponíveis em *Xbox* e *Playstation*, terão suas versões de tabuleiro lançadas em 2022.

Este trabalho de conclusão do curso tem o objetivo de analisar um *dataset* e construir visualizações gráficas a partir de seus dados. Uma das sugestões do curso foi a base de dados __*Board Games*__, disponibilizada pelo *Kaggle* e utilizada pelo *Tidytuesday* em um de seus eventos semanais que desafiam os usuários da linguagem R a construirem visualizações sobre um tema e assim promover discussões saudáveis. Decidi usá-la para a elaboração deste trabalho.

Exploraremos os dados e construiremos as visualizações para os chamados __*Solo Board Games*__, aqueles que permitem partidas com apenas um jogador. Destacaremos os jogos desta categoria considerando:

- melhores médias na avaliações de usuários;  
- posição no ranking;  
- mais citados nas listas de desejos e nas listas de procurados;
- indicação etária e
- mais comercializados de acordo com a base analisada.  


</div>


```{r leitura de pacotes}
#| echo = TRUE,
#| message = FALSE,
#| include = FALSE

library(tidyverse)
library(readr)
library(ggtext)
library(stringr)
library(kableExtra)
library(ggrepel)
library(shiny)
library(plotly)
library(forcats)
source("../R/funcoes_jogos.R")
```



```{r leitura da base}
#| echo = TRUE,
#| message = FALSE,
#| include = FALSE

jogos_tabuleiro <- read_rds("../data/base_preparada.RDS")
```

# Descrição das variáveis

<div align=justify style="text-indent: 3em;"> A base *"Board Games"* é composta pelas bases *"ratings"* e *"details"* que trazem as seguintes variáveis:
</div>

<style type="text/css">
.tg  {border-collapse:collapse;border-color:#bbb;border-spacing:0;}
.tg td{background-color:#E0FFEB;border-color:#bbb;border-style:solid;border-width:1px;color:#594F4F;
  font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:4px 5px;word-break:normal;}
.tg th{background-color:#9DE0AD;border-color:#bbb;border-style:solid;border-width:1px;color:#493F3F;
  font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:4px 5px;word-break:normal;}
.tg .tg-onvs{background-color:#ffffff;border-color:#c0c0c0;color:#000000;font-family:Arial, Helvetica, sans-serif !important;
  font-size:13px;text-align:left;vertical-align:top}
.tg .tg-nfzr{background-color:#ecf4ff;border-color:#c0c0c0;color:#000000;font-family:Arial, Helvetica, sans-serif !important;
  font-size:13px;text-align:left;vertical-align:top}
.tg .tg-nh0w{background-color:#237ca9;border-color:#c0c0c0;color:#ffffff;font-family:Arial, Helvetica, sans-serif !important;
  font-size:14px;font-weight:bold;text-align:center;vertical-align:top}
.tg .tg-xbii{background-color:#237ca9;border-color:#c0c0c0;color:#ffffff;font-family:Arial, Helvetica, sans-serif !important;
  font-size:13px;font-weight:bold;text-align:left;vertical-align:middle}
.tg .tg-ddzq{background-color:#237ca9;border-color:#c0c0c0;color:#ffffff;font-family:Arial, Helvetica, sans-serif !important;
  font-size:13px;font-weight:bold;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 827px">
<colgroup>
<col style="width: 211.005682px">
<col style="width: 211.005682px">
<col style="width: 405.005682px">
</colgroup>
<thead>
  <tr>
    <th class="tg-nh0w" colspan="3">Ratings.CSV</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-xbii">Variável</td>
    <td class="tg-ddzq">Tipo</td>
    <td class="tg-ddzq">Descrição</td>
  </tr>
  <tr>
    <td class="tg-nfzr">num</td>
    <td class="tg-nfzr">double</td>
    <td class="tg-nfzr">Número do jogo</td>
  </tr>
  <tr>
    <td class="tg-onvs">id</td>
    <td class="tg-onvs">double</td>
    <td class="tg-onvs">ID do jogo</td>
  </tr>
  <tr>
    <td class="tg-nfzr">name</td>
    <td class="tg-nfzr">character</td>
    <td class="tg-nfzr">Nome do jogo</td>
  </tr>
  <tr>
    <td class="tg-onvs">year</td>
    <td class="tg-onvs">double      </td>
    <td class="tg-onvs">Ano de lançamento    </td>
  </tr>
  <tr>
    <td class="tg-nfzr">rank</td>
    <td class="tg-nfzr">double</td>
    <td class="tg-nfzr">Ranking </td>
  </tr>
  <tr>
    <td class="tg-onvs">average</td>
    <td class="tg-onvs">double</td>
    <td class="tg-onvs">Média</td>
  </tr>
  <tr>
    <td class="tg-nfzr">bayes_average</td>
    <td class="tg-nfzr">double</td>
    <td class="tg-nfzr">Média bayesiana</td>
  </tr>
  <tr>
    <td class="tg-onvs">users_rated</td>
    <td class="tg-onvs">double</td>
    <td class="tg-onvs">Total de votações dos usuários</td>
  </tr>
  <tr>
    <td class="tg-nfzr">url</td>
    <td class="tg-nfzr">character</td>
    <td class="tg-nfzr">URL do jogo</td>
  </tr>
  <tr>
    <td class="tg-onvs">thumbnail</td>
    <td class="tg-onvs">character</td>
    <td class="tg-onvs">Thumbnail do jogo</td>
  </tr>
</tbody>
</table>
<br>

<div>

<style type="text/css">
.tg  {border-collapse:collapse;border-color:#ccc;border-spacing:0;}
.tg td{background-color:#fff;border-color:#ccc;border-style:solid;border-width:1px;color:#333;
  font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:4px 5px;word-break:normal;}
.tg th{background-color:#f0f0f0;border-color:#ccc;border-style:solid;border-width:1px;color:#333;
  font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:4px 5px;word-break:normal;}
.tg .tg-onvs{background-color:#ffffff;border-color:#c0c0c0;color:#000000;font-family:Arial, Helvetica, sans-serif !important;
  font-size:13px;text-align:left;vertical-align:top}
.tg .tg-nfzr{background-color:#ecf4ff;border-color:#c0c0c0;color:#000000;font-family:Arial, Helvetica, sans-serif !important;
  font-size:13px;text-align:left;vertical-align:top}
.tg .tg-nh0w{background-color:#237ca9;border-color:#c0c0c0;color:#ffffff;font-family:Arial, Helvetica, sans-serif !important;
  font-size:14px;font-weight:bold;text-align:center;vertical-align:top}
.tg .tg-xbii{background-color:#237ca9;border-color:#c0c0c0;color:#ffffff;font-family:Arial, Helvetica, sans-serif !important;
  font-size:13px;font-weight:bold;text-align:left;vertical-align:middle}
.tg .tg-ddzq{background-color:#237ca9;border-color:#c0c0c0;color:#ffffff;font-family:Arial, Helvetica, sans-serif !important;
  font-size:13px;font-weight:bold;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 837px">
<colgroup>
<col style="width: 215.005682px">
<col style="width: 215.005682px">
<col style="width: 407.005682px">
</colgroup>
<thead>
  <tr>
    <th class="tg-nh0w" colspan="3">Details.csv</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-xbii">Variável                      </td>
    <td class="tg-ddzq">Tipo                          </td>
    <td class="tg-ddzq">Descrição                    </td>
  </tr>
  <tr>
    <td class="tg-nfzr">num</td>
    <td class="tg-nfzr">double</td>
    <td class="tg-nfzr">Número do jogo</td>
  </tr>
  <tr>
    <td class="tg-onvs">id</td>
    <td class="tg-onvs">double</td>
    <td class="tg-onvs">ID do jogo</td>
  </tr>
  <tr>
    <td class="tg-nfzr">primary</td>
    <td class="tg-nfzr">character</td>
    <td class="tg-nfzr">Nome do jogo</td>
  </tr>
  <tr>
    <td class="tg-onvs">year published</td>
    <td class="tg-onvs">double      </td>
    <td class="tg-onvs">Ano de lançamento    </td>
  </tr>
  <tr>
    <td class="tg-nfzr">min_players</td>
    <td class="tg-nfzr">double</td>
    <td class="tg-nfzr">Número mínimo de jogadores</td>
  </tr>
  <tr>
    <td class="tg-onvs">max_players</td>
    <td class="tg-onvs">double</td>
    <td class="tg-onvs">Número máximo de jogadores</td>
  </tr>
  <tr>
    <td class="tg-nfzr">playing_time</td>
    <td class="tg-nfzr">double</td>
    <td class="tg-nfzr">Tempo de jogo em minutos</td>
  </tr>
  <tr>
    <td class="tg-onvs">min_play_time</td>
    <td class="tg-onvs">double</td>
    <td class="tg-onvs">Tempo mínimo de jogo em minutos</td>
  </tr>
  <tr>
    <td class="tg-nfzr">max_play_time</td>
    <td class="tg-nfzr">double</td>
    <td class="tg-nfzr">Tempo máximo de jogo em minutos</td>
  </tr>
  <tr>
    <td class="tg-onvs">min_age</td>
    <td class="tg-onvs">double</td>
    <td class="tg-onvs">Idade mínima</td>
  </tr>
  <tr>
    <td class="tg-nfzr">board_game_category</td>
    <td class="tg-nfzr">character</td>
    <td class="tg-nfzr">Categoria</td>
  </tr>
  <tr>
    <td class="tg-onvs">board_game_mechanic</td>
    <td class="tg-onvs">character</td>
    <td class="tg-onvs">Mecânica </td>
  </tr>
  <tr>
    <td class="tg-nfzr">board_game_family</td>
    <td class="tg-nfzr">character </td>
    <td class="tg-nfzr">Família do jogo</td>
  </tr>
  <tr>
    <td class="tg-onvs">board_game_expansion</td>
    <td class="tg-onvs">character</td>
    <td class="tg-onvs">Expansão</td>
  </tr>
  <tr>
    <td class="tg-nfzr">board_game_implementation</td>
    <td class="tg-nfzr">character</td>
    <td class="tg-nfzr">Execução</td>
  </tr>
  <tr>
    <td class="tg-onvs">board_game_designer</td>
    <td class="tg-onvs">character</td>
    <td class="tg-onvs">Designer / Criador</td>
  </tr>
  <tr>
    <td class="tg-nfzr">board_game_artist</td>
    <td class="tg-nfzr">character</td>
    <td class="tg-nfzr">Artista</td>
  </tr>
  <tr>
    <td class="tg-onvs">board_game_publisher</td>
    <td class="tg-onvs">character</td>
    <td class="tg-onvs">Editora</td>
  </tr>
  <tr>
    <td class="tg-nfzr">owned</td>
    <td class="tg-nfzr">double</td>
    <td class="tg-nfzr">Adquiridos</td>
  </tr>
  <tr>
    <td class="tg-onvs">trading</td>
    <td class="tg-onvs">double</td>
    <td class="tg-onvs">Comercializados</td>
  </tr>
  <tr>
    <td class="tg-nfzr">wanting</td>
    <td class="tg-nfzr">double</td>
    <td class="tg-nfzr">Número de usuários que gostariam de adquirir o jogo</td>
  </tr>
  <tr>
    <td class="tg-onvs">wishing</td>
    <td class="tg-onvs">double</td>
    <td class="tg-onvs">Número de usuários que desejariam ganhar o jogo</td>
  </tr>
</tbody>
</table>

</div>
<br>
<div align=justify style="text-indent: 3em;"> A união destas bases resulta em um *dataset* com `r nrow(jogos_tabuleiro)` linhas e `r ncol(jogos_tabuleiro)` variáveis de jogos com diversos temas,  diferentes tempos de duração, mecânicas de jogos e outros dados importantes para quem deseja adquirir um jogo de tabuleiro como faixa etária e existência de extensão de jogos, que permitem repetir o jogo em novas aventuras.


</div>


# Análises


## Melhores do Ranking e sua notas médias.

<div align=justify style="text-indent: 3em;"> Assim como os jogos digitais, alguns jogos de tabuleiro permitem que a partida seja realizada por apenas um jogador, o qual pode aproveitar momentos em que se encontra só, deixar de lado, ao menos por um tempo, a tecnologia e viver uma divertida aventura. 

No seguinte gráfico, conhecido como *"lollypop plot"*, temos os jogos com as melhores avaliações de acordo com suas posições no ranking geral, considerando as notas médias bayesianas.

Relacionamos os 20 jogos **melhores avaliados** entre aqueles com no mínimo 10.000 avaliações.

</div>

```{r grafico01 - Jogos para um jogador}
#| echo = TRUE,
#| fig.align="center",
#| fig.width = 9,
#| fig.height = 7,
#| out.width = 1500 ,
#| out.height = 800,

cor <- c(                                          # pallet de cores para os elementos gráficos.
    "#C2D9FF", "#871607", "#081121", "#EA250B", "#30292F",
    "#CCAA00", "#CB8589", "#811192", "#EF7B45", "#4BB3FD",
    "#735CDD", "#BD2554", "#829DB0", "#0DF205", "#37000A",
    "#201E1F", "#632A50", "#390099", "#F2542D", "#0A369D"
    )

jogos_tabuleiro |>
    filter(users_rated >= 10000 & !is.na(rank) & min_players == 1) |>
    arrange(rank) |>                                                      # ordenar por ranking.
    slice_head(n = 20) |>                                           # vinte primeiros elementos.
    ggplot(aes(
        x = fct_reorder(name,
                        rank,
                        .desc = TRUE
                        ),                                 # reordenar as colunas como fatores.
        y = rank,
        label = round(bayes_average, 2)
        )
        ) +
    geom_segment(aes(x = fct_reorder(name,
                                     rank,
                                     .desc = TRUE),                # criar o elemento segmento.
                     xend = name,
                     y = 0,
                     yend = rank
                     ),
                 color = cor,   
                 size = 1.5
                 ) +
    geom_point(aes(color = year),                                    # criar o elemento círculo.
               size = 8.5,
               color = cor    
               ) +
    geom_label(                                                            # formatar os labels.
        size = 3, 
        alpha = 0,
        label.size = NA,    
        fontface = "bold",    
        color = "#FFFFFF"  
        ) +
    geom_curve(aes(y = 2.5,                                      # formatar curva para anotação.
                   x = 20,  
                   xend = 17,     
                   yend = 25   
                   ),
               arrow = arrow(                                        # formatar a seta da curva.
                 type = "closed",          
                 length = unit(0.02, "npc")     
                 ),
               curvature = -0.1,  
               color = "#C2D9FF"   
               ) +
    labs(                                         # editar o texto do título, subtítulo e eixos.
        title = "Jogos de Tabuleiro para quem for jogar 
        *<span style = 'color:#D7CF07;'>sozinho!!</span>*",
        subtitle ="Os vinte melhores jogos com suas posições no ranking geral e notas médias",
        y = "Ranking dos Jogos",
        x = ""
        ) +
    theme_classic() +                                              # seleção do tema do gráfico.
    scale_y_continuous(breaks = seq(1, 46, 2),                      # formatar escala do eixo x.
                       limits = c(0,46)) +                    
    theme(                                                          # customizar:
        panel.background = element_rect(fill = "#237CA9"),                   # fundo do gráfico.
        plot.background = element_rect(fill = "#237CA9"),         # fundo da moldura retangular.
        plot.margin = unit(c(1, 2, 1, 0), "cm"),                     # distância das margens.
        plot.title = element_markdown(                                      # título do gráfico.
            size = 18,  
            face = "plain",    
            family = "",                                                      # fonte do título.
            hjust = 0,
            margin = unit(c(0, 0, 0.5, 0.5), "cm")                          # margens do título.
            ), 
        plot.subtitle = element_text(
            size = 10,
            family = "",   
            hjust = 0,
            ),
        text = element_text(                                                # textos do gráfica.
            family = "",    
            color = "#FFFFFF",
            size = 10,
            hjust = 0,
            face = "bold"
            ),
        axis.text.x = element_text(                                           # texto do eixo x.
            color = "#FFFFFF",       
            size = 7.5,
            face = "bold",
            margin = unit(c(0.3, 0, 0.5, 0), "cm")  
            ),
        axis.text.y = element_text(                                           # texto do eixo y.
            color = "#FFFFFF",    
            size = 9.5,
            face = "bold",
            family = "", 
            margin = unit(c(0, 0.5, 0, 0.5), "cm")
            ),
      axis.ticks.x = element_line(color = "#1F1F1F"),                         # ticks do eixo x.
      axis.line.x = element_line(color = "#1F1F1F"),                   # cor da linha do eixo x.
      axis.ticks.y = element_line(color = "#1F1F1F"),             # padrões dos ticks do eixo x.
      axis.line.y = element_line(
          color = "#000000",                                           # cor da linha do eixo x.
          size = 0.4,
          ),
      axis.title = element_text(                                    # texto do título do eixo x.
          face = "bold",    
          size = 10,
          hjust = 0.5,
          ),
      legend.position = "none"                                               # exclui a legenda.
      ) +
    coord_flip() +                                                       # inverte o eixo x e y.
    annotate( "text",
               x = 15, y = 33, label = " 
               Considerando o ranking, Gloomhavem é a
               melhor indicação. Ele ocupa a 1ª  posição
               no rankig geral entre jogos  de  tabuleiro  
               com a nota 8.51.                                          
              ",
               color = "#C2D9FF", 
               size = 3.2,
               family = "",
               fontface = "bold"
              )

```

## O mais desejados e seus *rankings*

<div align=justify style="text-indent: 3em;">Entende-se por mais desejados aqueles jogos que os avaliadores expressaram sua vontade de ganhá-los, ou seja, colocaram-nos em suas *wishlists* (listas de desejos).

O gráfico a seguir apresenta os vinte jogos **mais desejados**, considerando aqueles com mais de 10000 avaliações.

</div>

```{r grafico02 - Jogos para um jogador-b}
#| echo = TRUE,
#| fig.align="center",
#| fig.width = 9,
#| fig.height = 7,
#| out.width = 1500 ,
#| out.height = 800,

jogos_tabuleiro |>
    filter(users_rated >= 10000 & !is.na(rank) & min_players == 1) |>
    arrange(desc(wishing)) |>
    slice_head(n = 20) |>
    ggplot(aes(
        x = fct_reorder(name,
                        wishing,
                        .desc = FALSE
                                    ),                     # reordenar as colunas como fatores.
        y = wishing,
        label = round(rank, 2)
        )
        )+
    geom_segment(aes(
        x = fct_reorder(name,
                        wishing,
                        .desc = FALSE
                        ),                                          # criar o elemento segmento.
        xend = name,
        y = 0,
        yend = wishing
    ),
    color = cor,         
    size = 1.5
    ) +
    geom_point(aes(color = year),                                    # criar o elemento círculo.
               size = 8.5,
               color = cor                     
    ) +
    geom_label(                                                             # formata os labels.
        size = 3,    
        alpha = 0,
        label.size = NA,
        fontface = "bold",
        color = "#FFFFFF"
    ) +
    geom_curve(aes(                                              # formatar curva para anotação.
        x = 20,
        y = 21000,
        xend = 6,
        yend = 19200
    ),
    arrow = arrow(                                                   # formatar a seta da curva.
        type = "closed",                                                             
        length = unit(0.02, "npc")
    ),
    curvature = -0.4,                             # editar o texto do título, subtítulo e eixos.
    color = "#C2D9FF"
    ) +
    labs(                                         # editar o texto do título, subtítulo e eixos.
        title = "Jogos de Tabuleiro para quem for jogar *<span style = 'color:#FFC745;'>
        sozinho!!</span>*",
        subtitle ="Os vinte jogos mais desejados com suas posições e ranking",
        y = "Ranking dos Jogos",
        x = ""
    ) +
    theme_classic() +                                              # seleção do tema do gráfico.
    scale_y_continuous(breaks = seq(0, 27000, 2000),
                       limits = c(0, 27000)) +
    theme(                                                    # customizar:
        panel.background = element_rect(fill = "#237CA9"),                   # fundo do gráfico.
        plot.background = element_rect(fill = "#237CA9"),         # fundo da moldura retangular.
        plot.margin = unit(c(1, 1, 1, -0.3), "cm"),
        plot.title = element_markdown(                                      # título do gráfico.
            size = 18,
            face = "plain",
            family = "",
            hjust = 0,
            margin = unit(c(0, 0, 0.5, 0), "cm")
        ),
        plot.subtitle = element_text   (                                  # padrões do subítulo.
            size = 10,
            family = "",
            hjust = 0,
            ),
        text = element_text(                                                # textos do gráfica.
            family = "",
            color = "#FFFFFF",
            size = 10,
            hjust = 0,
            face = "bold"
        ),
        
        axis.text.x = element_text(                                           # texto do eixo x.
            color = "#FFFFFF",
            size = 7.5,
            face = "bold",
            margin = unit(c(0.3, 0, 0.5, 0), "cm")
            ),
        axis.text.y = element_text    (                                       # texto do eixo y.
            color = "#FFFFFF",
            size = 9.5,
            face = "bold",
            family = "",
            ),
        axis.ticks.x = element_line(color = "#1F1F1F"),                       # ticks do eixo x.
        axis.line.x = element_line(color = "#1F1F1F"),                 # cor da linha do eixo x.
        axis.ticks.y = element_line(color = "#1F1F1F"),           # padrões dos ticks do eixo x.
        axis.line.y = element_line(                                # padrões da linha do eixo x.
            color = "#000000",
            size = 0.4,
            ),
        axis.title = element_text(                                  # texto do título do eixo x.
          face = "bold",
          size = 10,
          hjust = 0.5,
          ),
        legend.position = "none"                                  # exclui a legenda do gráfico.
    ) +
    coord_flip() +                                              # inverte o eixo x com o eixo y.
    annotate(                                                         # faz anotação no gráfico.
        "text",
        x = 3.5, y = 19800, label = "
    Agora  temos  os  jogos  mais desejados  e seus
    rankings.  Observe  que os  jogos Scythe,           
    Terraforming  Mars,  Gloomhaven,  Spirit Island, 
    Gaia Project e Nemesis continuam em destaque,
    mas Wingspan e Everdell também se                  
    sobressaíram!                                                      
    ",
        color = "#C2D9FF", size = 3.1,
        family = "",
        fontface = "bold"
    )
```


## Jogos por Categoria

```{r analise mais desejados por categoria e tempo minimo}
#| echo = FALSE

# Melhores jogos para jogar sozinho por tema, considerando o ranking, os mais desejados,
# menor tempo, médio de jogo

# Os melhores por categoria

best_for_category <- function(.category_name) {
    jogos_tabuleiro_categoria |> 
        select(name, min_play_time, wishing, category, rank, owned, min_players) |>
        filter(category == .category_name & min_play_time <=160 & min_players ==1 & owned >=500)|> 
        arrange(desc(wishing)) |> 
        head(2) |>
        slice_max(wishing)
}


# Separar a coluna description em outras 5 colunas
jogos_tabuleiro_categoria <- jogos_tabuleiro |>
    separate(col = board_game_category,
             into = c("category1",
                      "category2",
                      "category3",
                      "category4",
                      "category5"),
        sep = "\\,",
        remove = TRUE
    )

# Pivotar a base de wide para long e então analisar as categorias.

jogos_tabuleiro_categoria <- jogos_tabuleiro_categoria |>
    pivot_longer(
        cols = c("category1", "category2", "category3",
                 "category4", "category5"),
        names_to = "category_number",
        values_to = "category",
        values_drop_na = TRUE
    )



# categorias selecionadas (Selecionamos algumas categorias)
categorias <- c("Ancient", 
                "Card Game",
                "City Building",
                "Civilization", 
                "Economic",
                "Trains", 
                "Deduction", 
                "Party Game",
                "Spies/Secret Agents",
                "Word Game",
                "Environmental",
                "Industry / Manufacturing",
                "Science Fiction",
                "Space Exploration",
                "Animals",
                "Farming",
                "Renaissance",
                "Fighting",
                "Miniatures",
                "Fantasy",
                "Abstract Strategy",
                "Puzzle",
                "Dice", 
                "Movies / TV / Radio theme",
                "Educational",
                "Humor",
                "Bluffing", 
                "Adventure", 
                "Exploration", 
                "Prehistoric",
                "Medical",
                "Modern Warfare",
                "Horror")
    
 # Obtenção dos melhores por categoria por meio da função best_for_category()

best_ancient <- best_for_category(categorias[1])
best_card_game <- best_for_category(categorias[2])
best_city_building <- best_for_category(categorias[3])
best_civilization <- best_for_category(categorias[4])
best_economic <- best_for_category(categorias[5])
best_trains <- best_for_category(categorias[6])
best_deduction <- best_for_category(categorias[7])
best_party_game <- best_for_category(categorias[8])
best_spies_secrets_agents <- best_for_category(categorias[9])
best_word_game <- best_for_category(categorias[10])
best_environmental <- best_for_category(categorias[11])
best_industry_manufacturing <- best_for_category(categorias[12])
best_science_fiction <- best_for_category(categorias[13])
best_space_exploration <- best_for_category(categorias[14])
best_animals <- best_for_category(categorias[15])
best_farming <- best_for_category(categorias[16])
best_renaissance <- best_for_category(categorias[17])
best_fighting <- best_for_category(categorias[18])
best_miniatures <- best_for_category(categorias[19])
best_fantasy <- best_for_category(categorias[20])
best_abstract_strategy <- best_for_category(categorias[21])
best_puzzle <- best_for_category(categorias[22])
best_dice <- best_for_category(categorias[23])
best_movie <- best_for_category(categorias[24])
best_educational <- best_for_category(categorias[25])
best_humor <- best_for_category(categorias[26])
best_bluffing <- best_for_category(categorias[27])
best_adventure <- best_for_category(categorias[28])
best_exploration <- best_for_category(categorias[29])
best_prehistoric <- best_for_category(categorias[30])
best_medical <- best_for_category(categorias[31])
best_modern_warfare <- best_for_category(categorias[32])
best_horror <- best_for_category(categorias[33])


# os melhores do ranking fora da lista
terraforming_mars <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |> 
    filter(name == "Terraforming Mars") |> 
    arrange(desc(category)) |> 
    head(1)

gloomhaven <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Gloomhaven") |> 
    arrange(desc(category)) |> 
    head(1)

gloomhaven_jaws_of_the_lion <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Gloomhaven: Jaws of the Lion") |> 
    arrange(desc(category)) |> 
    head(1)

gaia_project <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Gaia Project") |> 
    arrange(desc(category)) |> 
    head(1)

dune_imperium <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Dune: Imperium") |> 
    arrange(desc(category)) |> 
    head(1)

nemesis <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Nemesis") |> 
    arrange(desc(category)) |> 
    head(1)

a_feast_for_odin <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "A Feast for Odin") |> 
    arrange(desc(category)) |> 
    head(1)

wingspan <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Wingspan") |> 
    arrange(desc(category)) |> 
    head(1)

everdell <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Everdell") |> 
    arrange(desc(category)) |> 
    head(1)

scythe <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Scythe") |> 
    arrange(desc(category)) |> 
    head(1)

caverna_the_caves_farmers <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Caverna: The Cave Farmers") |> 
    arrange(desc(category)) |> 
    head(1)

the_7_continent <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "The 7th Continent") |> 
    arrange(desc(category)) |> 
    head(1)

spirit_island <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Spirit Island") |> 
    arrange(desc(category)) |> 
    head(1)

wingspan <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Wingspan") |> 
    arrange(desc(category)) |> 
    head(1)

arkhan_horror <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Arkhan Horror: The Card Game") |> 
    arrange(desc(category)) |> 
    head(1)

viticulture <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Viticulture Essential Edition") |> 
    arrange(desc(category)) |> 
    head(1)

robinson_crusoe <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Robinson Crusoe: Adventures on the Cursed Island") |> 
    arrange(desc(category)) |> 
    head(1)

agricola <- jogos_tabuleiro_categoria |> 
    select(name, min_play_time, wishing, category, rank, owned, min_players) |>
    filter(name == "Agricola") |> 
    arrange(desc(category)) |> 
    head(1)




```

<div align=justify style="text-indent: 3em;">A seguir, trazemos os jogos mais desejados organizados por **categoria**, com duração máxima de 160 minutos e adquiridos por mais de 5000 usuários (legenda amarela). 
Também traz alguns dos jogos que se destacam no **ranking** de notas médias (legenda azul).
</div>

```{r grafico jogos por categoria desejo ganhar presente e tempo minimo}
#| echo = TRUE,
#| fig.align="center",
#| fig.width = 10,
#| fig.height = 14.8,
#| out.width = 1700,
#| aut.height = 1800

jogos_tabuleiro_categoria |> 
    select(name, min_play_time,
           wishing,
           category, 
           rank, 
           owned, 
           min_players, 
           trading,
           min_play_time) |>
    filter(category %in% categorias & min_play_time <=160 & min_players ==1) |> 
    arrange(desc(wishing)) |>
    ggplot() +
    aes(x=wishing,
        y = category,
        color = min_play_time) +
    geom_point(size = 3)+
    labs(                                                  # texto de título, subtítulo e eixos.
    title = "Jogos Destaques por Categoria para Jogar *<span style = 'color:#FFC745;'>sozinho!!
    </span>*",
    subtitle = "Por categoria, desejo de ganhar como presente e tempo mínimo de jogo",
    x = "Número de Pessoas que Desejam o Jogo",                                 
    y = "")+                                                                    
    scale_x_continuous(breaks = seq(0, 20600, 5000),                            # padrões eixo x.
                       limits = c(0, 20600))+
    theme_classic() +                                                     # tema para o gráfico.
    theme(                                                       # customiza:
        panel.background = element_rect(fill = "#002642"),                   # fundo do gráfico.
        plot.background = element_rect(fill = "#237CA9"),              # fundo do frame externo.
        plot.margin = unit(c(1, 1, 1, -0.3), "cm"),                        # margens do gráfico.
        plot.title = element_markdown(                                      # padrões do título.
            size = 24,
            face = "plain",
            family = "",
            hjust = 0,
            margin = unit(c(0.2, 0, 0.5, 0), "cm")
        ),                                                   
        plot.subtitle = element_text (                                   # padrões do subtitulo.
            color = "#FFFFFF", 
            size = 12,
            hjust = 0,
            face = "bold"
        ),
        text = element_text(                                   # padrões dos elementos de texto.
            family = "",                         
            color = "#FFFFFF",
            size = 10,
            hjust = 0,
            face = "bold"
        ),
        axis.text.x = element_text(                                # padrões do texto do eixo x.
            color = "#FFFFFF",                                          
            size = 8,
            face = "bold",
            margin = unit(c(0.3, 0, 0.5, 0.5), "cm"),
            family = "",
        ),
        axis.ticks.x = element_line(color = "#000000"),           # padrões dos ticks do eixo x.
        axis.line.x = element_line(color = "#000000"),                   # eixo x na cor branca.
        axis.text.y = element_text(                                # padrões do texto do eixo y.
            family = "",
            color = "#FFFFFF",
            size = 11,
            face = "bold",
            margin = unit(c(0, 0.3, 0.3, 0), "cm"),
        ),                                                                 
        axis.ticks.y = element_line(color = "#000000"),           # padrões dos ticks do eixo y.
        axis.line.y = element_line(
            color = "#000000",
            size = 0.4,
        ),
        axis.title.x = element_text(                     # padrões da letra do titulo do eixo x.
            face = "bold",                                    
            size = 11,
            hjust = 0.5,
        ),
        legend.title = element_text(size = 9.2,        # padrões da texto do  titulo da legenda.
                                    color = "#FFFFFF", 
                                    face = "bold", 
                                    family = ""),
        legend.position = c(0.78,.86),              # posição da legenda para dentro do gráfico.
        legend.background = element_rect(fill = "#237CA9"),   # padrões para o fundo da legenda.
        legend.text = element_text(size = 6,                      # padrões do texto da legenda.
                                   color = "#FFFFFF",
                                   face = "bold"),
        legend.direction = "horizontal"                                    # posição da legenda.
    )+
    scale_color_gradient(low = "#F68DA0",             # padrões do escala do gradiente de cores.
                          # mid = "#FF708F",
                          high = "#840B21", 
                          # midpoint =11000,
                          name = "tempo mínimo")+                    # altera o nome da legenda.
    anotar(best_ancient)+    # chama a função anotar para inserir os nomes dos jogos no gráfico.
    anotar(best_card_game)+
    anotar(best_city_building)+
    anotar(best_civilization)+
    anotar(best_trains)+
    anotar(best_deduction)+
    anotar(best_party_game)+
    anotar(best_spies_secrets_agents)+
    anotar(best_word_game)+
    anotar(best_environmental)+
    anotar(best_industry_manufacturing)+
    anotar(best_science_fiction)+
    anotar(best_space_exploration)+
    anotar(best_animals)+
    anotar(best_farming)+
    anotar(best_renaissance)+
    anotar(best_fighting)+
    anotar(best_miniatures)+
    anotar(best_fantasy)+
    anotar(best_abstract_strategy)+
    anotar(best_puzzle)+
    anotar(best_dice)+
    anotar(best_educational)+
    anotar(best_humor)+
    anotar(best_bluffing)+
    anotar(best_exploration)+
    anotar(best_prehistoric)+
    anotar(best_modern_warfare)+
    anotar(best_horror)+
    anotar(best_humor)+
    anotar_1_ranking(terraforming_mars)+
    anotar_1_ranking(gloomhaven)+
    anotar_1_ranking(gloomhaven_jaws_of_the_lion)+
    anotar_2_ranking(gaia_project)+
    anotar_1_ranking(nemesis)+
    anotar_1_ranking(a_feast_for_odin)+
    anotar_2_ranking(everdell)+
    anotar_2_ranking(scythe)+
    anotar_1_ranking(dune_imperium)+
    anotar_1_ranking(caverna_the_caves_farmers)+
    anotar_1_ranking(the_7_continent)+
    anotar_1_ranking(arkhan_horror)+
    anotar_2_ranking(viticulture)+
    anotar_2_ranking(robinson_crusoe)+
    anotar_2_ranking(agricola)+
    annotate("rect",                                     # cria retângulo ao redor das legendas.
             xmin = 13150, 
             xmax = 20600, 
             ymin = 28, 
             ymax = 32 ,
             fill = "#237CA9",
             color = "#FFFFFF", 
             alpha = 1)+
    annotate("rect",               # cria retângulo para legenda "mais desejados por categoria".
             xmin = 18900, 
             xmax = 19900, 
             ymin = 30, 
             ymax = 30.6,
             fill = "#C1EEFF", 
             alpha = 1, 
             color = "#1F1F1F", 
             size = 0.3)+
    annotate("rect",                  # cria retângulo para legenda "melhores no ranking geral".
             xmin = 18900, 
             xmax = 19900, 
             ymin = 30.6, 
             ymax = 31.2,
             fill = "#FFEFB8", 
             alpha = 1, 
             color = "#000000", 
             size = 0.3)+
    annotate("text",                     # cria texto da legenda "mais desejados por categoria".
             x = 16100, 
             y = 30.7, 
             label = "mais desejados por categoria",
             color = "#FFFFFF", family = "",
             size = 3.2, 
             fontface = "bold")+
    annotate("text",                        # cria texto da legenda "melhores no ranking geral".
             x = 16350, 
             y = 30.1, 
             label = "melhores no ranking geral",
             color = "#FFFFFF", family = "",
             size = 3.2,
             fontface = "bold")

```


## Idade mínima

<div align=justify style="text-indent: 3em;">
Para encontrar os jogos "solo" com duração mínima inferior a 160 minutos disponíveis por **faixa etária**, forneça a categoria e a idade para visualizar quais opções existem entre os mais desejados e sua posição no ranking de notas:

</div>

```{r Categoria e idade minima - dados}
#| echo = FALSE

# Função retorna dados filtrados considerando tempo mínimo de jogo, mínimo de jogdores, mínimo
# adquiridos e idade mínima
best_for_category_ages<- function(.category_name) {
    jogos_tabuleiro_categoria |> 
        select(name,
               min_play_time,
               wishing,
               category,
               rank,
               owned, 
               min_players, 
               min_age) |>
        filter(category == .category_name & min_play_time <=160 & min_players>=1 & owned >=5000) 
}

```

```{r select input - idade minima e categoria}
#| echo = TRUE,
#| fig.align="center",
#| fig.width = 10,
#| fig.height = 14.8,
#| out.width = 1700,
#| aut.height = 1800

fluidPage(
    theme = bslib::bs_theme(bootswatch = "united"),         # alterar a aparência do aplicativo.
    sidebarLayout(                                                      # usar o layout sidebar.
             sidebarPanel(width = 12.0,                            # largura do painel de input.
                 sliderInput(                              # recebe intervalo idade pelo slider.
                     inputId = "idade_minima",
                     label = "Informe a idade mínima do jogador",
                     min = min(jogos_tabuleiro_categoria$min_age, na.rm = TRUE),
                     max = 30,                 # idade mínima máxima da base = 25, definimos 30.
                     step = 1,
                     value = 16,                         # valor inicial escolhido para o slider.
                     sep = " ",
                     width = "450px"                      # largura do slider dentro do sidebar.
                     ),
                 selectInput(                          # recebe a categoria do jogo pelo select.
                     inputId = "categoria_jogo",
                     label = "Forneça a categoria do jogo",
                     choices = c("Ancient", 
                                 "Card Game",
                                 "City Building",
                                 "Civilization", 
                                 "Economic",
                                 "Deduction", 
                                 "Spies/Secret Agents",
                                 "Word Game",
                                 "Science Fiction",
                                 "Animals",
                                 "Farming",
                                 "Renaissance",
                                 "Fighting",
                                 "Miniatures",
                                 "Fantasy",
                                 "Abstract Strategy",
                                 "Puzzle",
                                 "Dice", 
                                 "Movies / TV / Radio theme",
                                 "Educational",
                                 "Humor",
                                 "Bluffing", 
                                 "Adventure", 
                                 "Exploration", 
                                 "Prehistoric",
                                 "Medical",
                                 "Modern Warfare",
                                 "Horror"),
                     width = "450px"                # largura do select input dentro do sidebar.
                     )
                 ),
             mainPanel = mainPanel(width = 12,                    # largura do painel principal.
                 fluidRow(
                     column(
                         width = 12,                   # largura da coluna ocupada no mainPanel.
                         offset = 0,
                         output$p1 <- renderPlotly({                      # renderiza o gráfico.
                             jogos_tabuleiro_categoria |> 
                                 select(name,
                                        min_play_time, 
                                        wishing, 
                                        category, 
                                        rank, 
                                        owned, 
                                        min_players, 
                                        min_age) |>
                                 filter(category == input$categoria_jogo &
                                            min_players ==1 &
                                            min_play_time <= 160,
                                            min_age <= input$idade_minima) |>
                                 group_by(min_age) |>
                                 arrange(desc(wishing)) |> 
                                 #head(200) |> 
                                 ggplot(aes(x = rank, 
                                            y = wishing, 
                                            color = min_play_time,
                                            label = name
                                            )
                                        )+
                                 geom_point() +
                                 theme_classic()+
                                 labs(
                                     title = "JOGOS MAIS DESEJADOS POR IDADE PARA JOGAR 
<span style = 'color:#D7CF07;'>SOZINHO!!</span>",
                                     x = "Ranking",
                                     y = "Quantidade de usuários que desejam o jogo
                                     "
                                     )+
                                 theme(              # customiza o gráfico nos elementos abaixo.
                                     panel.background = element_rect(fill = "#FFFFFF"),
                                     plot.background = element_rect(fill = "#237CA9"), 
                                     plot.margin = unit(c(1.5, 1, 1, 1), "cm"),   
                                     plot.title = element_markdown(           
                                         size = 12,
                                         face = "plain",
                                         hjust = 0.5
                                         ),
                                     text = element_text(     
                                         color = "#000000",
                                         size = 10,
                                         hjust = 0,
                                         face = "bold"
                                         ),
                                     axis.text.x = element_text(  
                                         color = "#FFFFFF",
                                         size = 8,
                                         face = "plain"
                                         ),
                                     axis.text.y = element_markdown( 
                                        color = "#FFFFFF",
                                        size = 8,
                                        face = "plain",
                                        ),
                                     axis.title = element_text(
                                         size = 9,
                                         hjust = 0.5
                                         ),
                                     legend.title = element_text(size = 9.2,
                                                                 color = "#FFFFFF",
                                                                 face = "bold", 
                                                                 family = "arial"),
                                     legend.background = element_rect(fill = "#237CA9"), 
                                     legend.text = element_text(size = 6,
                                                                color = "#FFFFFF",
                                                                face = "bold"),
                                     )+
                                 scale_color_gradient(name = "tempo mínimo")+  
                                 scale_y_continuous(breaks = seq(0, 20000, 2000))+  
                                 scale_x_continuous(breaks = seq(0, 22000, 2000)) 
                             }
                         ),
                         output$t1 <- renderText(                  # renderiza o texto na saída.
                             glue::glue("O intervalo de 0 a {input$idade_minima} anos")
                         )
                     )
                 )
             )
            
         )
    )

```


# Descrição dos jogos

<div align=justify style="text-indent: 3em;">Com base nos dados analisados, listamos os jogos citados neste trabalho.
</div>

```{r tabela primeira selecao de jogos}
#| echo: FALSE

jogos_selecao01 <- c(                               # relação dos jogos citados neste trabalho.
    "A Feast for Odin", "Agricola", "Arkham Horror: The Card Game", "Black Angel", "Black Orchestra",
    "Burgle Bros.", "Cascadia", "Caverna: The Cave Farmers", "Dune: Imperium", "Everdell",
    "Endless Winter: Paleoamericans", "Facts in Five", "Gaia Project",
    "Gandhi: The Decolonization of British India, 1917 – 1947", "Gloomhaven", "Gloomhaven: Jaws of the Lion",
    "Ghost Stories", "Gutenberg", "Horrified", "Le Havre", "Lost Ruins of Arnak", "Mage Knight Board Game",
    "Mansions of Madness: Second Edition", "Maracaibo", "Marvel Champions: The Card Game", "Nemesis",
    "Neuroshima Hex! 3.0", "Prolix", "Reykholt", "Robinson Crusoe: Adventures on the Cursed Island",
    "Sagrada", "Scythe", "Shakespeare", "Snowdonia", "Space Race", "Spirit Island", "Tang Garden",
    "Tapestry", "Teotihuacan: City of Gods", "Terraforming Mars", "The 7th Continent", "Ubongo", 
    "UBOOT: The Board Game", "Underwater Cities", "Viticulture Essential Edition", "Wingspan"
    )

selecao01 <- jogos_tabuleiro |>          # seleção das colunas com as informações para a tabela.
  select(
    name,
    year,
    min_players,
    min_age,
    playing_time,
    min_play_time,
    max_play_time
  ) |>
  filter(jogos_tabuleiro$name %in% jogos_selecao01) |>  # filt. os dados de acordo com selecao1.
    arrange(name) |> 
  kable(col.names = c("nome", "ano", "min jogadores",  #renom. na tabela os nomes das variáveis.
        "min idade", "tempo jogo", "min tempo jogo",
        "max tempo jogo"),
        align = "l"
        ) |> 
    kable_styling(                                          # altera as configurações da tabela.
        bootstrap_options = c("striped", 
                              "condensed"
                              ),
        html_font = "",
        font_size = 10,
        full_width = TRUE, 
        fixed_thead = list(enabled = TRUE,
                           background = "#EDF6FD"
                           ),
        )|> 
    kable_classic_2() |> 
    column_spec(1,                                          # altera as configurações das colunas.
                bold = FALSE,
                width = "10cm",
                ) |>      
    column_spec(2, 
                bold = FALSE,
                width = "2cm"
                ) |>
    column_spec(3,
                bold = FALSE,
                width = "4cm"
                ) |> 
    column_spec(4,
                bold = FALSE,
                width = "4cm"
                ) |> 
    column_spec(5,
                bold = FALSE,
                width = "4cm"
                ) |> 
    column_spec(6,
                bold = FALSE,
                width = "10cm"
                ) |> 
    column_spec(7,
                bold = FALSE,
                width = "10cm"
                ) |> 
  footnote(general = "Base de dados Board Games - disponível na plataforma Kaggle.",
           footnote_as_chunk = TRUE,
           fixed_small_size = TRUE,
           general_title = "Fonte:",
           )
selecao01                                                          # mostra a tabela no retório.
```

<br>

<div align=justify style="text-indent: 3em;"> Você pode encontrar a descrição completa destes jogos, selecionado o título para ler a descrição completa:
</div>


```{r sidebarlayout input nome output descricao}
#| echo: FALSE

jogos_tabuleiro_traduzido <- read_csv("../data/filmes_descricao.csv")

fluidPage(                                 # selecionar o nome do filme para acesso à descrição.
    sidebarLayout(                               # input dos dados à esquerda e saída à direita.
        sidebarPanel = sidebarPanel(width = 5.0,     # painel para o input dos nomes dos filmes.
            div(style = "margin-right: 35px; 
                font-size:18;
                text-align:left;",                        # aumentar a margem direita do painel.
                div(style = "text-align:left;",
                    div(style = "text-align:left;color:#000000;",
                        shiny::selectInput(
                inputId = "nome",                          # cria a chave para acesso aos dados.
                label = "Jogo:" ,         # label no painel.
                choices = jogos_selecao01,
                )
                )
            )
            )
        ),
        mainPanel = mainPanel(        # vamos definir a saída dos dados à direita do inputPanel.
            fluidRow(
                column(
                    width = 12,
                    offset =0,
                    div(style = "background-color:#ecf4ff;
                        width:850px;
                        color:#F3F6F6;
                        font-weight:normal;
                        line-height:1.8;",
                        output$tab1 <- renderTable(                        # renderiza a tabela.
                        {
                            descricao <- jogos_tabuleiro_traduzido |>   
                                filter(name == input$nome) |> 
                                select(description) |> 
                                 rename("Descrição" = "description") 
                            descricao
                    },
                    width = "850px", # largura do texto para ocupar todo a largura do relatório.
                )
                )
            ),
            width = 12
        ),
        position = "justify",
    )
    )
 )


```


# Material de Apoio

<div align=justify style="text-indent: 3em;">
- Temas para RMarkdown por [Andrew Ziefler](https://www.datadreaming.org/post/r-markdown-theme-gallery/)
- Personalização de tabelas com kableExtra por [Hao Zhu](https://haozhu233.github.io/kableExtra/awesome_table_in_html.html)
- Livro sobre R - [Ciência de dados em R - Curso R](https://livro.curso-r.com/)
- Zen do R - Formas simples de melhorar a organização de projetos - [Caio Lente + Curso-R](https://curso-r.github.io/zen-do-r/)
- Livro sobre Shiny - [O'Reilly Media](https://mastering-shiny.org/index.html)

- Paletas para seleção de cores - [coolors](https://coolors.co/fcfafa-c8d3d5-a4b8c4-6e8387-0cca4a)

</div>

# Conclusão

<div align=justify style="text-indent: 3em;">Realizada a análise dos jogos para usuários "solo", por meio das visualizações, podemos observar que nem todos os jogos do topo do *ranking* estão entre os mais desejados.  

Fatores como preço, tempo mínimo de duração, categoria, mecânica, faixa etária afetam o desejo de ganhar ou comprar um jogo. Além disto, a existência de diversos temas tornam difícil a escolha do melhor para comprar ou pedir de presente, pois temas que não chamam a atenção do jogador os tornam desinteressantes, então é preciso escolher bem entre os vários disponiveis.  

Sobre o tempo, os jogos com 4 horas ou mais de duração talvez não sejam a melhor opção para quem quer jogar sozinho e se quem vai jogar é uma criança, deve-se observar a idade mínima. Muitos jogos exigem o raciocínio analítico e o uso de estratégias avançadas, por este motivo os fabricantes informam a idade mínima recomendada.

Neste trabalho encontramos 46 opções de jogos que permitem uma aventura "solo", mas o melhor jogo depende de cada jogador. Em uma era de video games, um jogo de tabuleiro pode ser uma agradável surpresa, então, não espere um apagão para se divertir. 


</div>


